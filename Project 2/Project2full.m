                                   %%Computer Project 2
                                   %%Code by K S Adarsh Raj
       %%Part A: Phase Plane Portrait
    %Defining 39 Initial Conditions and saving the data 
%define the 1st intial conditions
x10=0;
x20=2;
%call the simulation
sim('Project2');
%save the data
x11=x1;
x21=x2;
%define the 2nd intial conditions
x10=2;
x20=0;
%call the simulation
sim('Project2');
%save the data
x12=x1;
x22=x2;
%define the 3rd intial conditions
x10=0;
x20=-2;
%call the simulation
sim('Project2');
%save the data
x13=x1;
x23=x2;
%define the 4th intial conditions
x10=-2;
x20=0;
%call the simulation
sim('Project2');
%save the data
x14=x1;
x24=x2;
%define the 5th intial conditions
x10=0;
x20=1.98;
%call the simulation
sim('Project2');
%save the data
x15=x1;
x25=x2;
%define the 6th intial conditions
x10=1.98;
x20=0;
%call the simulation
sim('Project2');
%save the data
x16=x1;
x26=x2;
%define the 7th intial conditions
x10=0;
x20=-1.98;
%call the simulation
sim('Project2');
%save the data
x17=x1;
x27=x2;
%define the 8th intial conditions
x10=-1.98;
x20=0;
%call the simulation
sim('Project2');
%save the data
x18=x1;
x28=x2;
%define the 9th intial conditions
x10=1.5;
x20=1;
%call the simulation
sim('Project2');
%save the data
x19=x1;
x29=x2;
%define the 10th intial conditions
x10=1;
x20=-1.5;
%call the simulation
sim('Project2');
%save the data
x110=x1;
x210=x2;
%define the 11th intial conditions
x10=-1.5;
x20=-1;
%call the simulation
sim('Project2');
%save the data
x111=x1;
x211=x2;
%define the 12th intial conditions
x10=-1;
x20=1.5;
%call the simulation
sim('Project2');
%save the data
x112=x1;
x212=x2;
%define the 13th intial conditions
x10=1.5;
x20=-0.25;
%call the simulation
sim('Project2');
%save the data
x113=x1;
x213=x2;
%define the 14th intial conditions
x10=-1.5;
x20=0.25;
%call the simulation
sim('Project2');
%save the data
x114=x1;
x214=x2;
%define the 15th intial conditions
x10=0;
x20=2.01;
%call the simulation
sim('Project2');
%save the data
x115=x1;
x215=x2;
%define the 16th intial conditions
x10=0.9;
x20=1.9;
%call the simulation
sim('Project2');
%save the data
x116=x1;
x216=x2;
%define the 17th intial conditions
x10=1.3;
x20=1.7;
%call the simulation
sim('Project2');
%save the data
x117=x1;
x217=x2;
%define the 18th intial conditions
x10=1.6;
x20=1.4;
%call the simulation
sim('Project2');
%save the data
x118=x1;
x218=x2;
%define the 19th intial conditions
x10=1.9;
x20=0.9;
%call the simulation
sim('Project2');
%save the data
x119=x1;
x219=x2;
%define the 20th intial conditions
x10=1.8;
x20=0.9;
%call the simulation
sim('Project2');
%save the data
x120=x1;
x220=x2;
%define the 21st intial conditions
x10=2.01;
x20=0.3;
%call the simulation
sim('Project2');
%save the data
x121=x1;
x221=x2;
%define the 22nd intial conditions
x10=-0.2;
x20=2.1;
%call the simulation
sim('Project2');
%save the data
x122=x1;
x222=x2;
%define the 23rd intial conditions
x10=-0.9;
x20=1.9;
%call the simulation
sim('Project2');
%save the data
x123=x1;
x223=x2;
%define the 24th intial conditions
x10=-1.3;
x20=1.7;
%call the simulation
sim('Project2');
%save the data
x124=x1;
x224=x2;
%define the 25th intial conditions
x10=-1.6;
x20=1.4;
%call the simulation
sim('Project2');
%save the data
x125=x1;
x225=x2;
%define the 26th intial conditions
x10=-1.8;
x20=1;
%call the simulation
sim('Project2');
%save the data
x126=x1;
x226=x2;
%define the 27th intial conditions
x10=-2.01;
x20=0;
%call the simulation
sim('Project2');
%save the data
x127=x1;
x227=x2;
%define the 28th intial conditions
x10=-2;
x20=-0.4;
%call the simulation
sim('Project2');
%save the data
x128=x1;
x228=x2;
%define the 29th intial conditions
x10=0.2;
x20=-2.05;
%call the simulation
sim('Project2');
%save the data
x129=x1;
x229=x2;
%define the 30th intial conditions
x10=-0.9;
x20=-1.9;
%call the simulation
sim('Project2');
%save the data
x130=x1;
x230=x2;
%define the 31st intial conditions
x10=-1.3;
x20=-1.7;
%call the simulation
sim('Project2');
%save the data
x131=x1;
x231=x2;
%define the 32nd intial conditions
x10=-1.6;
x20=-1.4;
%call the simulation
sim('Project2');
%save the data
x132=x1;
x232=x2;
%define the 33rd intial conditions
x10=-1.8;
x20=-1;
%call the simulation
sim('Project2');
%save the data
x133=x1;
x233=x2;
%define the 34th intial conditions
x10=0.1;
x20=-2.01;
%call the simulation
sim('Project2');
%save the data
x134=x1;
x234=x2;
%define the 35th intial conditions
x10=0.7;
x20=-1.9;
%call the simulation
sim('Project2');
%save the data
x135=x1;
x235=x2;
%define the 36th intial conditions
x10=1.1;
x20=-1.8;
%call the simulation
sim('Project2');
%save the data
x136=x1;
x236=x2;
%define the 37th intial conditions
x10=1.4;
x20=-1.6;
%call the simulation
sim('Project2');
%save the data
x137=x1;
x237=x2;
%define the 38th intial conditions
x10=1.8;
x20=-1;
%call the simulation
sim('Project2');
%save the data
x138=x1;
x238=x2;
%define the 39th intial conditions
x10=2;
x20=-0.5;
%call the simulation
sim('Project2');
%save the data
x139=x1;
x239=x2;

%Plotting the Phase Plane Portrait for the 39 Initial Conditions
plot(x11,x21,x12,x22,x13,x23,x14,x24,x15,x25,x16,x26,x17,x27,x18,x28,x19,x29,x110,x210,x111,x211,x112,x212,x113,x213,x114,x214,x115,x215,x116,x216,x117,x217,x118,x218,x119,x219,x120,x220,x121,x221,x122,x222,x123,x223,x124,x224,x125,x225,x126,x226,x127,x227,x128,x228,x129,x229,x130,x230,x131,x231,x132,x232,x133,x233,x134,x234,x135,x235,x136,x236,x137,x237,x138,x238,x139,x239)
grid on
axis([-5 5 -5 5]);
title('State Plane Portrait,X_2 Vs X_1');
xlabel('X_1');
ylabel('X_2');

      
         %%Part B: Finding the Equilibrium Points using Fminsearch
%Inital Guess given in question
xb10=10;
xb20=10;
z0=[xb10,xb20];
%Calling the fminsearch
z=fminsearch('find_equilibirum_points',z0)  %Call the "find_equilibrium_points" function
x1e=z(1)
x2e=z(2)


        %%Part C: Finding the Linearised State Space Model using Linmod
[A,B,C,D]=linmod('Project2b')

    
        %%Part D: Finding the Eigen Values, Damping Ratio and Natural Frequency
damp(A)      %This function gives the eigen values, damping ratio, natural frequency


        %%Part E: Comparing the Linear and Non Linear Responses
%1st IC for NL Part
x10=0.4;
x20=0.4;
%Call the NL Simulation
sim('Project2')
%Save the NL data
x1nl1=x1;
x2nl1=x2;
%1st IC for Linear Part
c0=[0;0];  %Zero Vector, input for the state space model
x10ss=x10-x1e;
x20ss=x20-x2e;
xss=[x10ss;x20ss];
%call the simulation
sim('Project2eLin')
%save the Linear data
x1l1=x1l;
x2l1=x2l;
%Plot the Linear and Non Linear Responses
figure(2),plot(tout,x1nl1,tout1,x1l1+x1e)
title('Time Response of X_1 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=0.4]');
xlabel('Time(s)'),ylabel('X_1');
grid on
figure(3),plot(tout,x2nl1,tout1,x2l1+x2e)
title('Time Response of X_2 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=0.4]');
xlabel('Time(s)'),ylabel('X_2');
grid on

%2nd IC for NL Part
x10=1;
x20=1;
%Call the NL Simulation
sim('Project2')
%Save The data
x1nl2=x1;
x2nl2=x2;
%2nd IC for Linear Part
c0=[0;0];
x10ss=x10-x1e;
x20ss=x20-x2e;
xss=[x10ss;x20ss];
%call the simulation
sim('Project2eLin')
%save the data
x1l2=x1l;
x2l2=x2l;
%Plot the Linear and Non Linear Responses 
figure(4),plot(tout,x1nl2,tout1,x1l2+x1e)
title('Time Response of X_1 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=1]');
xlabel('Time(s)'),ylabel('X_1');
grid on
figure(5),plot(tout,x2nl2,tout1,x2l2+x2e)
title('Time Response of X_2 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=1]');
xlabel('Time(s)'),ylabel('X_2');
grid on

%3rd IC for NL Part
x10=1.4;
x20=1.4;
%Call the NL Simulation
sim('Project2')
%Save The data
x1nl3=x1;
x2nl3=x2;
%3rd IC for Linear Part
c0=[0;0];
x10ss=x10-x1e;
x20ss=x20-x2e;
xss=[x10ss;x20ss];
%call the simulation
sim('Project2eLin')
%save the data
x1l3=x1l;
x2l3=x2l;
%Plot the Linear and Non Linear Responses 
figure(6),plot(tout,x1nl3,tout1,x1l3+x1e)
title('Time Response of X_1 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=1.4]');
xlabel('Time(s)'),ylabel('X_1');
grid on
figure(7),plot(tout,x2nl3,tout1,x2l3+x2e)
title('Time Response of X_2 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=1.4]');
xlabel('Time(s)'),ylabel('X_2');
grid on

%4th IC for NL Part
x10=sqrt(2);
x20=sqrt(2);
%Call the NL Simulation
sim('Project2')
%Save The data
x1nl4=x1;
x2nl4=x2;
%4th IC for Linear Part
c0=[0;0];
x10ss=x10-x1e;
x20ss=x20-x2e;
xss=[x10ss;x20ss];
%call the simulation
sim('Project2eLin')
%save the data
x1l4=x1l;
x2l4=x2l;
%Plot the Linear and Non Linear Responses 
figure(8),plot(tout,x1nl4,tout1,x1l4+x1e)
title('Time Response of X_1 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=sqrt(2)]');
xlabel('Time(s)'),ylabel('X_1');
grid on
figure(9),plot(tout,x2nl4,tout1,x2l4+x2e)
title('Time Response of X_2 for Linear and Non-Linear Model[IC,X_1(0)=X_2(0)=sqrt(2)]');
xlabel('Time(s)'),ylabel('X_2');
grid on